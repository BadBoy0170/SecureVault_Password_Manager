import{r as e,j as t,R as r,S as a,A as s,L as n,P as l,K as o,U as c,c as i}from"./vendor-Dc_agdpc.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();function d(e){const t=new Uint8Array(e);let r="";for(let a=0;a<t.byteLength;a++)r+=String.fromCharCode(t[a]);return btoa(r)}function u(e){const t=atob(e),r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r.buffer}async function m(e,t){if(!e||!t)throw new Error("Password and salt are required");try{const r=(new TextEncoder).encode(e),a=u(t),s=await crypto.subtle.importKey("raw",r,"PBKDF2",!1,["deriveBits","deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:1e5,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}catch(r){throw new Error("Failed to derive cryptographic key")}}async function p(e,t){if(!e)throw new Error("Data to encrypt cannot be empty");try{const r=new TextEncoder,a=crypto.getRandomValues(new Uint8Array(12));return{encryptedData:d(await crypto.subtle.encrypt({name:"AES-GCM",iv:a},t,r.encode(e))),iv:d(a)}}catch(r){throw new Error("Failed to encrypt data")}}async function h(e,t,r){if(!e||!t)throw new Error("Encrypted data and IV are required");try{const a=new TextDecoder,s=u(e),n=u(t),l=await crypto.subtle.decrypt({name:"AES-GCM",iv:n},r,s);return a.decode(l)}catch(a){throw new Error("Failed to decrypt data")}}function y(e=16,t={uppercase:!0,lowercase:!0,numbers:!0,symbols:!0}){if(e<8)throw new Error("Password length must be at least 8 characters");let r="";if(t.uppercase&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),t.lowercase&&(r+="abcdefghijklmnopqrstuvwxyz"),t.numbers&&(r+="0123456789"),t.symbols&&(r+="!@#$%^&*()_+-=[]{}|;:,.<>?"),0===r.length)throw new Error("At least one character set must be selected");return Array.from(crypto.getRandomValues(new Uint8Array(e))).map(e=>r[e%r.length]).join("")}const x="secure_vault_data",w="master_key";function g(){const[t,r]=e.useState(!1),[a,s]=e.useState(null),[n,l]=e.useState([]),[o,c]=e.useState(!0),[i,u]=e.useState(null),y=e.useCallback(async e=>{if(e.length<8)return u("Master password must be at least 8 characters long"),!1;try{const t=await async function(){try{return d(crypto.getRandomValues(new Uint8Array(16)))}catch(i){throw new Error("Cryptographic salt generation failed")}}(),a=await m(e,t),n=await p("verified",a),l={salt:t,verifier:JSON.stringify(n)};return localStorage.setItem(w,JSON.stringify(l)),s(a),r(!0),u(null),!0}catch(t){return u("Failed to set up master password"),!1}},[]),g=e.useCallback(async e=>{const t=localStorage.getItem(w);if(!t)return!1;try{const{salt:a,verifier:n}=JSON.parse(t),l=await m(e,a),{encryptedData:o,iv:c}=JSON.parse(n);return await h(o,c,l),s(l),r(!0),u(null),!0}catch{return u("Invalid master password"),!1}},[]),b=e.useCallback(async e=>{if(!a)throw u("Vault is locked"),new Error("Vault is locked");if(!e.title||!e.username||!e.password)throw u("Title, username, and password are required"),new Error("Incomplete credential");try{const t={...e,id:crypto.randomUUID(),createdAt:Date.now(),updatedAt:Date.now()},{encryptedData:r,iv:s}=await p(JSON.stringify(t),a),n={id:t.id,encryptedData:r,iv:s,createdAt:t.createdAt,updatedAt:t.updatedAt},o=localStorage.getItem(x),c=o?JSON.parse(o):[];return localStorage.setItem(x,JSON.stringify([...c,n])),l(e=>[...e,t]),u(null),t}catch(t){throw u("Failed to add credential"),t}},[a]),f=e.useCallback(async()=>{if(a)try{const e=localStorage.getItem(x);if(!e)return void l([]);const t=JSON.parse(e),r=await Promise.all(t.map(async({encryptedData:e,iv:t,...r})=>{const s=await h(e,t,a);return JSON.parse(s)}));l(r),u(null)}catch(e){u("Failed to load credentials"),l([])}},[a]);return e.useEffect(()=>{a?f().finally(()=>c(!1)):c(!1)},[a,f]),{isUnlocked:t,isLoading:o,credentials:n,setupMasterPassword:y,unlock:g,addCredential:b,error:i}}function b(){const{isUnlocked:i,isLoading:d,credentials:u,setupMasterPassword:m,unlock:p,addCredential:h,error:x}=g(),[w,b]=e.useState(""),[f,v]=e.useState(!1),[N,j]=e.useState({title:"",username:"",password:"",url:"",notes:""}),S=async e=>{e.preventDefault();localStorage.getItem("master_key")?await p(w):await m(w),b("")};return d?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin",children:t.jsx(r,{className:"w-8 h-8 text-blue-500"})})}):i?t.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("header",{className:"flex justify-between items-center mb-8",children:[t.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:[t.jsx(a,{className:"inline-block mr-3 h-8 w-8 text-blue-500"}),"SecureVault"]}),t.jsxs("button",{onClick:()=>v(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center",children:[t.jsx(l,{className:"h-5 w-5 mr-2"})," Add Credential"]})]}),x&&t.jsxs("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[t.jsx(s,{className:"inline-block mr-2 h-5 w-5"}),x]}),f&&t.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add New Credential"}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{await h(N),v(!1),j({title:"",username:"",password:"",url:"",notes:""})}catch(t){}},className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx("input",{type:"text",placeholder:"Title",value:N.title,onChange:e=>j(t=>({...t,title:e.target.value})),required:!0,className:"border rounded-md px-3 py-2"}),t.jsx("input",{type:"text",placeholder:"Username",value:N.username,onChange:e=>j(t=>({...t,username:e.target.value})),required:!0,className:"border rounded-md px-3 py-2"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Password",value:N.password,onChange:e=>j(t=>({...t,password:e.target.value})),required:!0,className:"border rounded-md px-3 py-2 w-full"}),t.jsx("button",{type:"button",onClick:()=>{j(e=>({...e,password:y()}))},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:t.jsx(r,{className:"h-5 w-5"})})]}),t.jsx("input",{type:"url",placeholder:"URL (optional)",value:N.url,onChange:e=>j(t=>({...t,url:e.target.value})),className:"border rounded-md px-3 py-2"})]}),t.jsx("textarea",{placeholder:"Notes (optional)",value:N.notes,onChange:e=>j(t=>({...t,notes:e.target.value})),className:"border rounded-md px-3 py-2 w-full",rows:3}),t.jsxs("div",{className:"flex justify-end space-x-4",children:[t.jsx("button",{type:"button",onClick:()=>v(!1),className:"text-gray-600 hover:text-gray-900",children:"Cancel"}),t.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Save Credential"})]})]})]}),t.jsx("div",{className:"grid gap-4",children:0===u.length?t.jsx("div",{className:"text-center text-gray-500 py-8",children:t.jsx("p",{children:"No credentials saved yet. Add your first credential!"})}):u.map(e=>t.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4 flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:e.title}),t.jsx("p",{className:"text-gray-600",children:e.username})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{className:"text-blue-500 hover:text-blue-700",title:"View Details",children:t.jsx(o,{className:"h-5 w-5"})}),t.jsx("button",{className:"text-red-500 hover:text-red-700",title:"Delete",children:t.jsx(c,{className:"h-5 w-5"})})]})]},e.id))})]})}):t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-white shadow-md rounded-xl",children:[t.jsxs("div",{className:"text-center",children:[t.jsx(a,{className:"mx-auto h-12 w-12 text-blue-500"}),t.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"SecureVault"})]}),x&&t.jsxs("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[t.jsx(s,{className:"inline-block mr-2 h-5 w-5"}),x]}),t.jsxs("form",{onSubmit:S,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"masterPassword",className:"sr-only",children:"Master Password"}),t.jsx("input",{id:"masterPassword",type:"password",required:!0,value:w,onChange:e=>b(e.target.value),className:"appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter Master Password"})]}),t.jsxs("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[t.jsx(n,{className:"h-5 w-5 mr-2"})," Unlock Vault"]})]})]})})}i(document.getElementById("root")).render(t.jsx(e.StrictMode,{children:t.jsx(b,{})}));
//# sourceMappingURL=index-DwAin_ia.js.map
